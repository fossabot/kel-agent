app-id: radio.k0swe.kel_agent.Kel_Agent
default-branch: main
runtime: org.freedesktop.Platform
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
build-options:
  append-path: /usr/lib/sdk/golang/bin
  build-args:
    # `go get` needs the network
    - '--share=network'
  env:
    - 'LDFLAGS='
command: kel-agent
finish-args:
  - --share=network
modules:
  - name: kel-agent
    sources:
      - type: dir
        path: ..
#      - type: git
#        url: ssh://git@github.com/k0swe/kel-agent.git
#        tag: v0.3.1
#        commit: a0d6751f8c490941ddf9815f409b111a2c4dbbff
    buildsystem: simple
    build-commands:
      - make
      - install -D kel-agent /app/bin/kel-agent
      - mkdir -p /app/share/icons/hicolor/scalable/apps/ && cp assets/radio.k0swe.kel_agent.Kel_Agent.svg /app/share/icons/hicolor/scalable/apps/
      - mkdir -p /app/share/metainfo/ && cp assets/radio.k0swe.kel_agent.Kel_Agent.metainfo.xml /app/share/metainfo/
      - mkdir -p /app/share/applications/ && cp assets/radio.k0swe.kel_agent.Kel_Agent.desktop /app/share/applications/
    cleanup:
      - /lib/debug
